# 亲子活动实验室微信小程序产品需求文档

## 产品概述

亲子活动实验室是一款结合 AI 能力与亲子陪伴理念的互动工具，面向有3–10岁孩子的家庭，通过生成高质量、低门槛、有互动感的任务卡片，提升家庭在日常生活中的创意陪伴质量。

### 主要使用场景

- 放学后的亲子时间
- 周末室内创作/共创活动
- 家庭聚会中的互动小游戏
- 临时需要"高质量亲子内容"的应急时刻

## 功能需求

### 1. 用户需求与功能分析

用户需要亲子活动实验室实现以下功能：

1. **活动卡片生成与浏览**
   - AI 生成个性化活动推荐
   - 按年龄段/场景/时长筛选活动
   - 收藏喜欢的活动

2. **活动执行与互动**
   - 活动步骤引导
   - 计时/完成打卡
   - 亲子互动记录（照片/视频）

3. **成长记录**
   - 活动完成记录
   - 亲子时光相册
   - 孩子成长数据

4. **社区分享**
   - 分享活动成果
   - 查看其他家庭作品
   - 评论与点赞

5. **个性化设置**
   - 孩子信息管理
   - 兴趣偏好设置
   - 活动提醒

## 界面设计与用户流程

### 1. 首页/发现页
- **顶部**：
  - 品牌名称"亲子活动实验室"
  - 搜索框
  - 通知图标

- **AI推荐合集区**（位于顶部）：
  - 水平滑动的合集卡片
  - 合集主题如"下雨天宅家必玩10种游戏"、"父子亲密度提升6种游戏"、"提升孩子自律性5种游戏"
  - 每个合集卡片包含主题图片、标题和活动数量
  - 点击可进入合集详情页

- **随机游戏CTA**：
  - 醒目的"随机一个"按钮
  - 配有有趣的动画效果（如转盘或洗牌）
  - 点击后随机展示一个活动详情

- **筛选区**：
  - 水平滚动的标签：全部、3-5岁、6-8岁、9-10岁、室内、户外、创意、科学等
  - 时长筛选：15分钟、30分钟、1小时+

- **活动卡片区**：
  - 每张卡片包含：活动图片、活动名称、适合年龄、预计时长、难度等级
  - 卡片右下角有收藏按钮
  - 瀑布流布局，支持下拉刷新

- **底部导航**：
  - 发现（首页）、合集、打卡、社区、我的

### 2. 活动详情页
- **顶部**：
  - 活动图片（大图展示）
  - 返回按钮
  - 收藏/分享按钮
- **活动信息区**：
  - 活动名称（大标题）
  - 适合年龄、预计时长、难度等标签
  - 活动简介
- **准备区**：
  - "准备材料"列表
  - 每项材料配有小图标
- **步骤区**：
  - 步骤卡片，包含序号、文字说明、配图
  - 步骤之间有连接线
- **底部按钮**：
  - 正常浏览时：大按钮"开始活动"
  - 从随机入口进入时：
    - 主按钮："就玩这个"（大按钮，突出显示）
    - 次要按钮："换一个"（小按钮，视觉上较弱）

### 3. 活动执行页
- **顶部**：
  - 活动名称
  - 计时器（显示已用时间）
  - 暂停/退出按钮
- **步骤展示**：
  - 大图示意当前步骤
  - 步骤描述文字
  - 语音播报按钮
- **互动区**：
  - 拍照/录制视频按钮
  - "我们完成了"按钮
- **进度指示器**：
  - 显示总步骤和当前步骤
  - 前进/后退按钮

### 4. 成果分享页
- **顶部**：
  - "分享成果"标题
  - 关闭按钮
- **活动信息**：
  - 活动名称和简介
  - 完成用时显示
- **媒体区**：
  - 上传的照片/视频预览
  - 添加更多媒体按钮
- **感想输入区**：
  - 文本框："和孩子的感想..."
- **分享选项**：
  - "保存到记录"按钮
  - "分享到社区"按钮（明确提示将展示在社区页）
  - "完成并打卡"按钮（连接打卡功能）
  - 微信分享按钮

### 5. 我的页面
- **顶部个人信息**：
  - 头像
  - 昵称
  - 家庭成员（孩子信息）
- **数据统计**：
  - 完成活动数
  - 亲子时间累计
  - 收获徽章
- **功能入口**：
  - 我的收藏
  - 成长记录
  - 家庭设置（添加/编辑孩子信息）
  - 兴趣设置
  - 消息通知
- **其他设置**：
  - 意见反馈
  - 关于我们

### 6. 成长记录页
- **顶部**：
  - "成长记录"标题
  - 日历/时间轴切换
- **筛选选项**：
  - 按孩子筛选（如有多个孩子）
  - 按活动类型筛选
- **记录展示**：
  - 时间轴形式
  - 每条记录包含：日期、活动名称、缩略图、简短感想
  - 点击可查看详情
- **数据统计**：
  - 本月完成活动数
  - 偏好活动类型分析

### 7. 社区页
- **顶部**：
  - "亲子社区"标题
  - 搜索按钮
- **内容分类**：
  - 全部
  - 活动分享（完成活动后的分享）
  - 打卡分享（日常打卡的分享）
  - 成就分享（获得成就/徽章的分享）
  - 关注
- **内容流**：
  - 所有类型的用户分享统一展示
  - 分享卡片根据类型有不同的视觉标识
  - 每张卡片包含：用户头像/昵称、分享类型标签、活动名称、分享图片/视频、文字描述、点赞/评论数
- **互动区**：
  - 点赞、评论、收藏按钮

### 8. 合集详情页
- **顶部**：
  - 合集封面大图
  - 合集名称（如"下雨天宅家必玩10种游戏"）
  - 返回按钮
  - 收藏合集按钮
- **合集信息**：
  - 合集简介
  - 活动数量
  - 创建者信息（系统/用户）
- **活动列表**：
  - 该合集内所有活动卡片
  - 支持按难度/时长等筛选
- **底部按钮**：
  - "创建我的合集"按钮
  - 分享合集按钮

### 9. 创建合集页
- **顶部**：
  - "创建合集"标题
- **基本信息**：
  - 合集名称输入框
  - 合集描述输入框
  - 上传合集封面
- **添加活动**：
  - 搜索活动
  - 从我的收藏中选择
  - 从历史记录中选择
- **预览区**：
  - 已添加活动的列表
  - 可拖动排序
- **底部按钮**：
  - "创建并分享"按钮
  - "仅保存"按钮

### 10. 打卡页面（简化版）
- **顶部**：
  - "亲子打卡"标题
  - 简洁的日历视图（显示本月打卡情况）
- **打卡统计**：
  - 本月打卡天数
  - 连续打卡天数（简单数字展示）
- **今日打卡**：
  - "记录今日亲子时光"按钮（若未打卡）
  - 今日已完成活动展示（若已打卡）
- **打卡记录**：
  - 简洁时间轴展示近期打卡记录
  - 每条记录包含基本信息
- **简单激励**：
  - 基础成就展示（如"连续打卡3天"、"首次打卡"）
  - 预留未来扩展的入口（标记为"即将推出"）

## 主要用户流程

### 1. 随机游戏流程
- 用户点击首页"随机一个"按钮
- 展示随机动画效果
- 跳转到随机选出的活动详情页
- 详情页底部显示两个按钮：
  - 主按钮："就玩这个"（视觉上突出）
  - 次要按钮："换一个"（视觉上较弱）
- 点击"换一个"继续随机，点击"就玩这个"进入活动执行页

### 2. 合集使用流程
- 用户浏览首页推荐合集
- 点击感兴趣的合集进入合集详情页
- 浏览合集内活动并选择感兴趣的活动
- 可收藏整个合集或单个活动
- 可创建自己的个性化合集

### 3. 社区统一展示流程
- 所有类型的分享内容统一在社区页展示：
  - 活动完成分享
  - 日常打卡分享
  - 成就获得分享
- 用户可通过顶部分类标签筛选查看特定类型的分享
- 不同类型分享有不同的视觉标识，便于区分
- 用户可以对任何类型的分享进行互动（点赞、评论、收藏）

### 4. 简化打卡功能流程
- 完成活动后在成果分享页选择"完成并打卡"
- 系统记录基本打卡信息
- 用户可查看简洁的打卡记录和基础统计
- 提供简单的初始成就（如首次打卡、连续打卡3天等）
- 预留未来扩展的入口，但当前保持功能简洁

## 视觉设计指南

### 配色方案
- **主色调**：明亮的蓝色（代表创意）和温暖的橙色（代表亲子温情）
- **辅助色**：柔和的绿色、紫色点缀
- **背景**：以白色为主，保持界面清爽

### 字体选择
- **主标题**：稍大加粗的无衬线字体，活泼有亲和力
- **正文**：清晰易读的无衬线字体

### 图标风格
- 圆润的线条图标，充满童趣但不幼稚
- 适当使用拟物化元素增加趣味性

### 插图风格
- 简约扁平化的卡通插画
- 色彩鲜明但不过于花哨
- 有助于吸引孩子和家长的注意力

## 后期优化方向

1. **打卡系统扩展**：
   - 完善成就与激励体系
   - 增加打卡挑战与任务

2. **AI能力增强**：
   - 根据用户历史活动数据更精准推荐
   - 自动生成个性化活动内容

3. **社交功能扩展**：
   - 家庭间互动与挑战
   - 亲子圈子与兴趣小组

4. **更多互动形式**：
   - 亲子互动小游戏
   - AR/VR互动体验 

## 开发技术方案

### 1. 技术架构选型

经过综合评估，我们决定采用**微信云开发**作为主要技术架构，主要基于以下几点考虑：

1. **无服务器开发**：云开发提供了完整的后端能力，无需自建服务器和数据库，降低了运维成本和开发复杂度。
2. **一站式解决方案**：包含数据库、存储、云函数、鉴权等完整后端服务，可满足我们的所有需求。
3. **无缝微信生态集成**：原生支持微信登录、支付、模板消息等微信能力，用户体验更一致。
4. **扩展性**：支持通过云函数扩展自定义后端逻辑，满足未来可能的扩展需求。
5. **成本效益**：有免费额度，前期用户量较小时几乎无成本，随着规模扩大可平滑扩容。

### 2. 前端技术方案

#### 2.1 基础框架

- **开发框架**：采用小程序原生框架 + TypeScript
- **UI组件库**：WeUI + 自定义组件
- **状态管理**：Mobx（简化版）

#### 2.2 目录结构设计

```
|- miniprogram/           # 小程序主目录
|  |- components/         # 公共组件
|  |  |- activity-card/   # 活动卡片组件
|  |  |- collection-card/ # 合集卡片组件
|  |  |- step-guide/      # 步骤引导组件
|  |  |- ...
|  |- pages/              # 页面目录
|  |  |- index/           # 首页/发现页
|  |  |- activity-detail/ # 活动详情页
|  |  |- activity-play/   # 活动执行页
|  |  |- share-result/    # 成果分享页
|  |  |- my-profile/      # 我的页面
|  |  |- growth-record/   # 成长记录页
|  |  |- community/       # 社区页
|  |  |- collection-detail/ # 合集详情页
|  |  |- create-collection/ # 创建合集页
|  |  |- check-in/        # 打卡页面
|  |  |- ...
|  |- utils/              # 工具函数
|  |- services/           # 服务层，与云函数交互
|  |- models/             # 数据模型
|  |- styles/             # 全局样式
|  |- assets/             # 静态资源
|  |- app.js              # 小程序入口文件
|  |- app.json            # 小程序配置文件
|  |- app.wxss            # 小程序全局样式
|- cloudfunctions/        # 云函数目录
|  |- getActivities/      # 获取活动列表
|  |- getCollections/     # 获取合集列表
|  |- randomActivity/     # 随机获取活动
|  |- uploadMedia/        # 上传媒体文件
|  |- recordCompletion/   # 记录活动完成
|  |- checkIn/            # 打卡相关函数
|  |- userStats/          # 用户统计数据
|  |- ...
```

#### 2.3 分包配置

为优化小程序体积和加载性能，我们采用分包加载：

- **主包**：首页、活动详情页、合集页面等核心功能
- **分包一**：社区相关功能
- **分包二**：打卡和成长记录相关功能
- **分包三**：个人设置和管理功能
- **独立分包**：活动执行页（可独立载入）

### 3. 后端技术方案（云开发）

#### 3.1 云数据库设计

**集合设计**：

1. **activities**：活动数据集合
   ```json
   {
     "_id": "activity_id",
     "name": "活动名称",
     "coverImage": "封面图片URL",
     "intro": "活动简介",
     "suitableAge": [3, 5],  // 适合年龄范围
     "duration": 30,         // 预计时长（分钟）
     "difficulty": 2,        // 难度等级 1-5
     "type": ["创意", "室内"],// 活动类型标签
     "materials": [          // 所需材料
       {
         "name": "彩纸",
         "icon": "icon_url"
       }
     ],
     "steps": [              // 活动步骤
       {
         "order": 1,
         "title": "步骤标题",
         "description": "步骤描述",
         "image": "步骤图片URL"
       }
     ],
     "createTime": "创建时间",
     "updateTime": "更新时间",
     "popularity": 0         // 热度
   }
   ```

2. **collections**：活动合集集合
   ```json
   {
     "_id": "collection_id",
     "name": "合集名称",
     "coverImage": "封面图片URL",
     "description": "合集描述",
     "activityCount": 10,
     "activityIds": ["activity_id1", "activity_id2"],
     "creator": {
       "type": "system",     // 系统创建或用户创建
       "userId": "user_id"   // 如果是用户创建
     },
     "createTime": "创建时间",
     "updateTime": "更新时间",
     "collectionCount": 0    // 被收藏次数
   }
   ```

3. **users**：用户数据集合
   ```json
   {
     "_id": "user_id",
     "openid": "微信openid",
     "nickName": "用户昵称",
     "avatarUrl": "头像URL",
     "children": [           // 孩子信息
       {
         "name": "孩子昵称",
         "age": 5,
         "gender": "男",
         "interests": ["创意", "科学"]
       }
     ],
     "preferences": {        // 用户偏好
       "activityTypes": ["创意", "户外"],
       "notifications": true
     },
     "stats": {              // 统计数据
       "completedActivities": 0,
       "totalPlayTime": 0,
       "achievements": ["首次打卡"]
     },
     "createTime": "创建时间"
   }
   ```

4. **favorites**：收藏数据集合
   ```json
   {
     "_id": "favorite_id",
     "userId": "user_id",
     "type": "activity",     // activity 或 collection
     "itemId": "activity_id",
     "createTime": "收藏时间"
   }
   ```

5. **records**：活动记录集合
   ```json
   {
     "_id": "record_id",
     "userId": "user_id",
     "activityId": "activity_id",
     "childName": "孩子昵称",
     "images": ["图片URL"],
     "duration": 25,         // 实际用时（分钟）
     "comment": "用户评论",
     "sharedToMoments": false,// 是否分享到社区
     "createTime": "完成时间"
   }
   ```

6. **checkins**：打卡记录集合
   ```json
   {
     "_id": "checkin_id",
     "userId": "user_id",
     "date": "2023-08-15",
     "recordIds": ["record_id"],// 关联的活动记录
     "createTime": "打卡时间"
   }
   ```

7. **posts**：社区分享集合
   ```json
   {
     "_id": "post_id",
     "userId": "user_id",
     "type": "activity",     // 分享类型：activity, checkin, achievement
     "content": "分享内容",
     "images": ["图片URL"],
     "relatedId": "activity_id",// 关联的活动/打卡/成就ID
     "likes": 0,             // 点赞数
     "comments": [           // 评论
       {
         "userId": "评论用户id",
         "content": "评论内容",
         "createTime": "评论时间"
       }
     ],
     "createTime": "分享时间"
   }
   ```

#### 3.2 云存储设计

文件存储结构：

- **activity-images/**：活动相关图片
  - **covers/**：活动封面图
  - **steps/**：步骤图片
- **collection-images/**：合集图片
- **user-uploads/**：用户上传的内容
  - **{userId}/**：按用户ID分组
    - **records/**：活动记录的照片/视频
    - **avatars/**：用户头像
- **system/**：系统资源
  - **icons/**：图标资源
  - **illustrations/**：插图资源

#### 3.3 云函数设计

核心云函数功能：

1. **用户相关**
   - `login`：用户登录与授权
   - `updateUserInfo`：更新用户信息
   - `getUserStats`：获取用户统计数据

2. **活动相关**
   - `getActivities`：获取活动列表，支持筛选和分页
   - `getActivityDetail`：获取活动详情
   - `randomActivity`：随机获取活动
   - `recordActivity`：记录活动完成信息

3. **合集相关**
   - `getCollections`：获取合集列表
   - `getCollectionDetail`：获取合集详情
   - `createCollection`：创建新合集
   - `updateCollection`：更新合集内容

4. **互动相关**
   - `uploadMedia`：上传媒体文件
   - `checkIn`：执行打卡
   - `getCheckInStats`：获取打卡统计数据
   - `shareToMoments`：分享到社区

5. **社区相关**
   - `getPosts`：获取社区帖子
   - `createPost`：创建新帖子
   - `likePost`：点赞帖子
   - `commentPost`：评论帖子

### 4. 数据流与交互逻辑

#### 4.1 基本数据流

```
用户界面 → 页面逻辑 → 服务层(services) → 云函数 → 云数据库/云存储
                                      ↑
                                      ↓
                    状态管理 ← 数据模型(models) ← 云函数返回数据
```

#### 4.2 关键交互流程

1. **首页数据加载流程**：
   ```
   onLoad() → 调用services.getCollections() → 云函数getCollections
                                            → 查询collections集合
                                            → 返回合集数据
           → 调用services.getActivities() → 云函数getActivities
                                          → 查询activities集合
                                          → 返回活动数据
           → 页面渲染
   ```

2. **随机活动流程**：
   ```
   点击"随机一个" → 调用services.randomActivity() → 云函数randomActivity
                                                → 随机查询activities集合
                                                → 返回随机活动
                  → 跳转到活动详情页
   ```

3. **活动执行与记录流程**：
   ```
   完成活动 → 填写记录信息 → 上传照片(services.uploadMedia)
                                       → 云函数uploadMedia
                                       → 存储到云存储
           → 提交记录(services.recordActivity)
                        → 云函数recordActivity
                        → 写入records集合
           → 选择是否分享到社区
                        → 云函数shareToMoments
                        → 写入posts集合
   ```

4. **打卡流程**：
   ```
   选择"完成并打卡" → 服务层调用checkIn云函数
                   → 云函数写入checkins集合
                   → 更新用户stats数据
                   → 返回打卡结果和成就信息
   ```

### 5. AI能力集成方案

#### 5.1 推荐系统

通过微信云开发的云函数，集成推荐算法：

1. **基于内容的推荐**：根据孩子年龄、兴趣标签匹配活动
2. **协同过滤**：根据用户行为相似度推荐活动
3. **热度排序**：根据完成次数、分享次数等计算活动热度

云函数实现逻辑：
```javascript
// 伪代码示例
async function recommendActivities(event, context) {
  const { userId } = event;
  
  // 获取用户信息和孩子信息
  const user = await db.collection('users').doc(userId).get();
  const childInterests = user.data.children[0].interests;
  const childAge = user.data.children[0].age;
  
  // 基于内容匹配
  const matchedActivities = await db.collection('activities')
    .where({
      suitableAge: _.lte(childAge).gte(childAge - 2),
      type: _.in(childInterests)
    })
    .limit(10)
    .get();
    
  // 可进一步结合协同过滤等算法
  
  return {
    activities: matchedActivities.data
  };
}
```

#### 5.2 自然语言处理

可通过微信AI能力或调用第三方API，实现：

1. **活动描述智能生成**：基于简单输入生成详细活动步骤
2. **用户分享内容分析**：识别分享文本的情感倾向
3. **评论内容审核**：自动过滤不良内容

### 6. 开发与部署流程

#### 6.1 开发环境

- **开发工具**：微信开发者工具
- **版本控制**：Git (GitHub/码云)
- **协作工具**：腾讯文档、企业微信

#### 6.2 开发流程

1. **第一阶段**：核心功能实现
   - 首页与活动详情页
   - 活动执行流程
   - 用户登录与基础信息

2. **第二阶段**：功能完善
   - 合集功能
   - 社区分享
   - 打卡系统

3. **第三阶段**：优化与测试
   - 性能优化
   - 界面polish
   - 用户测试与反馈收集

#### 6.3 部署策略

- **测试版本**：内部测试，仅开发团队可见
- **体验版本**：邀请部分种子用户测试
- **正式版本**：提交审核，上线小程序

#### 6.4 发布与迭代计划

- **首发版本(v1.0)**：核心功能，简化版打卡系统
- **迭代版本(v1.5)**：优化用户体验，完善社区功能
- **增强版本(v2.0)**：增加高级功能，如自定义活动创建

### 7. 技术风险与解决方案

#### 7.1 潜在风险

1. **小程序体积限制**：
   - 风险：随着功能增加，可能超出小程序体积限制(2MB)
   - 解决方案：合理分包、云存储静态资源、优化代码和资源

2. **用户生成内容管理**：
   - 风险：用户上传的图片/评论可能含有不适当内容
   - 解决方案：接入内容安全检测API，建立举报机制

3. **数据安全与隐私**：
   - 风险：涉及儿童信息的安全与隐私
   - 解决方案：最小化数据收集、加密存储、明确用户协议

4. **系统性能**：
   - 风险：随着用户增加，云开发资源可能不足
   - 解决方案：设置资源预警、优化数据库查询、考虑分区扩展

#### 7.2 技术债务管理

为避免技术债务积累，我们将采取：

1. 定期代码审查与重构
2. 完善的单元测试与集成测试
3. 详细的技术文档维护
4. 性能指标监控与优化

### 8. 后续技术扩展规划

#### 8.1 短期计划（3-6个月）

1. 引入基础数据分析能力，了解用户使用习惯
2. 优化推荐算法，提高活动匹配精度
3. 增强打卡系统的游戏化元素

#### 8.2 中长期计划（6-12个月）

1. 集成更高级的AI能力，如活动内容自动生成
2. 开发小程序插件，允许在其他场景中使用核心功能
3. 探索AR/VR互动可能性，增强活动体验

#### 8.3 技术探索方向

1. **语音交互**：为低龄儿童提供语音引导
2. **智能识别**：通过拍照识别活动中的物品和成果
3. **家庭互联**：多终端数据同步，实现家庭成员协作 